\ProvidesPackage{cvsqldb}[2021/05/11 Basic styles for the csvsqldb documentation]

\RequirePackage[top=3cm,bottom=3cm,left=3cm,right=3cm,headsep=10pt,a4paper]{geometry}
%\usepackage[parfill]{parskip}    % Activate to begin paragraphs with an empty line rather than an indent
\RequirePackage{graphicx}
\RequirePackage[clearempty,pagestyles,newlinetospace]{titlesec}
\RequirePackage{amssymb}
\RequirePackage{epstopdf}
\RequirePackage{enumitem}
\RequirePackage{lmodern}
\RequirePackage{microtype} % Slightly tweak font spacing for aesthetic
\RequirePackage[T1]{fontenc}
\RequirePackage[utf8]{inputenc}
\RequirePackage[english]{babel}
\RequirePackage{multirow}
\RequirePackage{color}
\RequirePackage[svgnames]{xcolor}
\RequirePackage{listings}
\RequirePackage[margin=10pt,font={small,sf},labelfont=bf]{caption}
\RequirePackage{marginnote}
\RequirePackage{booktabs}
\RequirePackage{tipa}
\RequirePackage{tcolorbox}
\RequirePackage{fancyhdr}
\RequirePackage{newfloat}
\RequirePackage{extendedbacknaur}
\RequirePackage{numprint}
\RequirePackage[numberFieldsTwice,littleEndian,numberBitsAbove]{bitpattern}
\RequirePackage{ccicons}
\RequirePackage{tikz}
\usetikzlibrary{automata, positioning, arrows.meta}
\RequirePackage[hyphens]{url}
\RequirePackage{bm}
\RequirePackage{bytefield}
\RequirePackage{beramono}

\bpStartAtBit{15}
\bpSetBitWidth{15px}
%----------------------------------------------------------------------------------------
%    DECLARATIONS
%----------------------------------------------------------------------------------------
\renewcommand{\sfdefault}{lmss}
\setlist{nolistsep} % Reduce spacing between bullet points and numbered lists

%----------------------------------------------------------------------------------------
%    PAGE HEADERS
%----------------------------------------------------------------------------------------
\pagestyle{fancy}
\renewcommand{\chaptermark}[1]{\markboth{\normalsize\sffamily\bfseries\chaptername\ \thechapter.\ #1}{}} % Chapter text font settings
\renewcommand{\sectionmark}[1]{\markright{\normalsize\sffamily\bfseries\thesection\hspace{5pt}#1}{}} % Section text font settings
\fancyhf{} \fancyhead[LE,RO]{\sffamily\bfseries\normalsize\thepage} % Font setting for the page number in the header
\fancyhead[LO]{\rightmark} % Print the nearest section name on the left side of odd pages
\fancyhead[RE]{\leftmark} % Print the current chapter name on the right side of even pages
\renewcommand{\headrulewidth}{0.5pt} % Width of the rule under the header
\addtolength{\headheight}{2.5pt} % Increase the spacing around the header slightly
\addtolength{\headsep}{10pt} % Increase the spacing below the header
\renewcommand{\footrulewidth}{0pt} % Removes the rule in the footer
\fancypagestyle{plain}{%
\fancyhead{}\renewcommand{\headrulewidth}{0pt}%
\cfoot{\normalsize\sffamily\bfseries\thepage}} % Style for when a plain pagestyle is specified

% Removes the header from odd empty pages at the end of chapters
\makeatletter
\renewcommand{\cleardoublepage}{
\clearpage\ifodd\c@page\else
\hbox{}
\vspace*{\fill}
\thispagestyle{empty}
\newpage
\fi}

%----------------------------------------------------------------------------------------
%    CHAPTER HEADINGS
%----------------------------------------------------------------------------------------
\titleformat{\chapter}[display]
{\normalfont\bfseries\filleft}
{\resizebox{10mm}{!}{\sffamily\bfseries \thechapter}}
{1ex}
{%\titlerule[2pt]
\vspace{2ex}%
\sffamily\Huge}
[\vspace{4ex}]

\titleformat{\section}
  {\normalfont\sffamily\Large\bfseries}{\thesection}{1em}{}

\titleformat{\subsection}
  {\normalfont\sffamily\large\bfseries}{\thesubsection}{1em}{}

\titleformat{\subsubsection}
  {\normalfont\sffamily\normalsize\bfseries}{\thesubsection}{1em}{}

%----------------------------------------------------------------------------------------
%    GRAPHICS
%----------------------------------------------------------------------------------------
\DeclareGraphicsRule{.tif}{png}{.png}{`convert #1 `dirname #1`/`basename #1 .tif`.png}

%\tikzset{
%->, % makes the edges directed
%>=stealth, % makes the arrow heads bold
%node distance=2cm, % specifies the minimum distance between two nodes. Change if necessary.
%every state/.style={thick, fill=gray!10}, % sets the properties for each ’state’ node
%}

%----------------------------------------------------------------------------------------
%    ITEMIZE AND ENUMERATE
%----------------------------------------------------------------------------------------
\setlist{itemsep=.1em}

%----------------------------------------------------------------------------------------
%    CAPTION STYLE
%----------------------------------------------------------------------------------------
%\DeclareCaptionFont{white}{\color{white}}
%\DeclareCaptionFormat{listing}{\colorbox{lightgray}{\parbox{\dimexpr\textwidth-2\fboxsep\relax}{#1#2#3}}}
%\captionsetup[lstlisting]{format=listing,font=small,labelfont=white,textfont=white}
%\captionsetup[table]{format=listing,font=small,labelfont=white,textfont=white}
%\captionsetup[figure]{format=listing,font=small,labelfont=white,textfont=white}
%\captionsetup[grammar]{format=listing,font=small,labelfont=white,textfont=white}

%----------------------------------------------------------------------------------------
%    LISTING STYLE
%----------------------------------------------------------------------------------------
\definecolor{comment}{rgb}{0.65, 0.65, 0.65}
\definecolor{string}{rgb}{0.16, 0.463, 0.816}
\definecolor{keyword1}{rgb}{0.0, 0.0, 1.0}
\definecolor{keyword2}{rgb}{0.0, 0.0, 1.0}
\definecolor{identifier}{rgb}{0.0, 0.0, 0.545}
\definecolor{backcolour}{rgb}{0.95, 0.95, 0.95}

\lstset{
basicstyle=\scriptsize\ttfamily,
numberstyle=\tiny\ttfamily,
numbersep=8pt,
tabsize=1,
showspaces=false,
showstringspaces=false,
breaklines=true,
emptylines=1,
xleftmargin=14pt,
keywordstyle=[1]\color{keyword1},
keywordstyle=[2]\color{keyword2},
commentstyle=\color{comment},
stringstyle=\color{string},
identifierstyle=\color{identifier},
backgroundcolor=\color{backcolour},
frame=single,
framerule=0pt
}

\tcbset{colback=gray!30!white, colframe=gray!75!black, arc=1mm, leftrule=2mm, left=1mm}

%----------------------------------------------------------------------------------------
%        LISTINGS
%----------------------------------------------------------------------------------------
\lstnewenvironment{ShellListing}[2]{%
\lstset{language=BASH, label=#1, caption=#2}
}{%
}

\lstnewenvironment{Bash}{%
\lstset{language=BASH}
}{%
}

\lstnewenvironment{SQL}{%
\lstset{language=SQL}
}{%
}

%----------------------------------------------------------------------------------------
%	MACROS
%----------------------------------------------------------------------------------------

\newcommand{\csvsqldb}{\textit{csvsqldb}}
\newcommand{\sqlex}[3]{\lstinputlisting[language=SQL,numbers=left,float=ht,label=#1,caption={#2}]{../examples/#3.sql}}
\newcommand{\sqlinline}[1]{\lstinline[language=SQL]!#1!}
\newcommand{\bashinline}[1]{\lstinline[language=BASH]!#1!}

%----------------------------------------------------------------------------------------
%    TABLES
%----------------------------------------------------------------------------------------
\newenvironment{FseTabular}[3]{% #1 = caption, #2 = columns, #3 = label
    \begin{table*}[!htbp]
    \sffamily
    \small
    \centering
    \caption{#1}
    \label{#3}
    \renewcommand{\arraystretch}{1.3}
    \begin{tabular}{@{}#2@{}}\toprule
}{%
    \bottomrule
    \end{tabular}
    \end{table*}
}

%----------------------------------------------------------------------------------------
%    ENVIRONMENT
%----------------------------------------------------------------------------------------
\newcommand{\ra}[1]{\renewcommand{\arraystretch}{#1}}

%----------------------------------------------------------------------------------------
%    FLOATING ENVIRONMENT FOR EBNF GRAMMERS
%----------------------------------------------------------------------------------------
\DeclareFloatingEnvironment[placement={!ht}]{grammar}

%----------------------------------------------------------------------------------------
%    FLOATING ENVIRONMENT FOR REGISTER MAPS
%----------------------------------------------------------------------------------------
\DeclareFloatingEnvironment[placement={!ht}]{register map}

%----------------------------------------------------------------------------------------
%    FLOATING ENVIRONMENT FOR MEMORY MAPS
%----------------------------------------------------------------------------------------
\DeclareFloatingEnvironment[placement={!ht}]{mmap}

% facilitates the creation of memory maps. Start address at the bottom,
% end address at the top.
% syntax:
% \memsection{end address}{start address}{height in lines}{text in box}
\newcommand{\memsection}[4]{%
% define the height of the memsection
\bytefieldsetup{bitheight=#3\baselineskip}%
\bitbox[]{10}{%
\texttt{#1}% print end address
\\
% do some spacing
\vspace{#3\baselineskip}
\vspace{-2\baselineskip}
\vspace{-#3pt}
\texttt{#2}% print start address
}%
\bitbox{16}{#4}% print box with caption
}

%----------------------------------------------------------------------------------------
%    INSTRUCTIONS
%----------------------------------------------------------------------------------------
\DeclareFloatingEnvironment[placement={!htb}]{instruction}
\captionsetup[instruction]{format=default,font=small,labelformat=empty}

\newcommand{\IInstruction}[4]{
\begin{instruction}%
\centering
\caption{I-Type Instruction}
\bitpattern#1{#2}[3]{#3}[3]{#4}[6]/
\end{instruction}
}

\newcommand{\JInstruction}[2]{
\begin{instruction}%
\centering
\caption{J-Type Instruction}
\bitpattern#1{#2}[12]/
\end{instruction}
}

\newcommand{\RInstruction}[5]{
\begin{instruction}%
\centering
\caption{R-Type Instruction}
\bitpattern#1{#2}[3]{#3}[3]{#4}[3]{#5}[3]/
\end{instruction}
}

\newcommand{\mono}[1]{\texttt{\small #1}}

\newcommand{\gpr}[1]{\lstinline{#1}}

\newcommand{\descmargin}{\vspace{3mm}}


\newenvironment{Instruction}{\begin{flushleft}}{\end{flushleft}}

\newcommand{\AddInstruction}[2]{
\newpage
\addcontentsline{toc}{subsection}{#1}

\begin{tcolorbox}
\textbf{#1} \hfill \textbf{#2}
\end{tcolorbox}
}

\newcommand{\InstructionFormat}[1]{
\textbf{Format:} \newline
\texttt{\small #1}
\descmargin
}

\newcommand{\InstructionClass}[1]{
\textbf{Class:} #1
\descmargin
}

\newcommand{\InstructionPurpose}[1]{
\textbf{Purpose:} \newline
#1
\descmargin
}

\newcommand{\tab}{\hspace{10px}}
\newcommand{\InstructionDescription}[2]{
\textbf{Description:} \newline
\texttt{\small #1}

#2
\descmargin
}

\newcommand{\InstructionExample}{
\textbf{Example:}
}

\newcommand{\InstructionRestrictions}[1]{
\textbf{Restrictions:} \newline
#1
\descmargin
}

\newcommand{\InstructionFlags}[2]{
\textbf{Status Flags:} \newline
\texttt{\small #1}

#2
\descmargin
}

\newcommand{\InstructionFlagsText}[1]{
\textbf{Status Flags:} \newline
#1
\descmargin
}

\newcommand{\InstructionNotes}[1]{
\textbf{Notes:} \newline
#1
\descmargin
}
